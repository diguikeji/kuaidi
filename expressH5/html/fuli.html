<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>福利</title>
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" />
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<link rel="stylesheet" href="../css/app.css">
	<link rel="stylesheet" href="../css/page.css">
	<link rel="stylesheet" href="../css/mui.min.css">
	<link rel="stylesheet" href="../css/swiper.min.css">
	<link rel="stylesheet" href="../css/firstPage.css">
	<style>
		body{background: #fff;overflow-x:hidden;}
		.fuli-list{padding-bottom:0.2rem;}
		.fuli-list li{height:1.15rem;width:100%;background: url("../images/fuli/fuli_12.jpg");background-size:100% 100%;border:1px solid rgba(243, 243, 243, 1);
			box-shadow:0px 2px 6px 0px rgba(126,125,125,0.14);position: relative;margin:0.1rem 0 0.1rem 0;padding-left:1.1rem;box-sizing: border-box;}

		.fuli-list li .img{width:0.9rem;height:0.9rem;position: absolute;left:0.12rem;top:0.13rem;}
		.fuli-list li .weizhi{height:11px;
			font-size:12px;
			font-weight:400;
			color:#666;
			line-height:14px;}
		.fuli-list li .biaoti{font-size:16px;padding-top:0.22rem;padding-bottom:0.06rem;
			font-weight:bold;
			color:rgba(51,51,51,1);
			line-height:14px;}
		.fuli-list li .weizhi img{width:0.12rem;position: relative;top:0.03rem;}
		.fuli-list li .riqi{color:#999;font-size:11px;position: absolute;bottom:0.1rem;}
		.fuli-list li .lingqu{position: absolute;right:0;top:0;font-size:0.15rem;color:#fff;text-align: center;width:0.66rem;height:1.15rem;box-sizing: border-box;padding-top:0.32rem;}

		.buzhou-list{height:0.5rem;box-shadow: 0 1px 3px #ccc;}
		.buzhou-list .swiper-slide{width:20%;float:left;text-align: center;color:#26262D;position:relative;height:0.5rem;font-size:0.13rem;font-weight: bold;line-height: normal;padding-top:0.08rem;}
		.buzhou-list .swiper-slide div{color:#333333;font-size:0.11rem;padding:0.02rem;}
		.buzhou-list .swiper-slide.disabled div{color:#CCCCCC;}
		.buzhou-list .swiper-slide.active{color:#fff;}
		.buzhou-list .swiper-slide.active div{color:#fff;position: relative;z-index:10;}
		.buzhou-list .swiper-slide.active span{position: relative;z-index:10;}
		.buzhou-list .swiper-slide.active:after{content:" ";display:block;height:0.55rem;top:0;left:0;position:absolute;width:100%;background: url("../images/fuli/fuli_08.png");background-size:100% 100%;}

		.fuli-top{position: fixed;text-align: center;height:0.6rem;padding-top:10px;box-shadow:0px 3px 27px 0px rgba(221,221,221,0.41);width:100%;z-index:1000;
		background: #fff;width:100%;left:0;
		}
		.fuli-top .left-col{position: absolute;left:15px;top:0;font-size:0.11rem;}
		.fuli-top .left-col div{width:0.4rem;line-height: 0.18rem;padding-top:0.2rem;color:#666;}
		.fuli-top .left-col img{width:0.16rem;position: absolute;right:-0.2rem;top:0.26rem;}
		.fuli-top .right-col div{font-size:0.11rem;color:#7A7A7A;position: relative;top:-0.04rem;}

		.fuli-top .right-col img{width:0.18rem;margin-top:0.1rem;}
		.fuli-top .right-col{position: absolute;right:0;top:0;padding:0.1rem 0.1rem;}

		.fuli-top .middle-col{color:#333;font-size:0.16rem;color:#999999;line-height: 0.52rem;}
		.fuli-top .middle-col span{display: inline-block;position: relative;padding:0 0.06rem;}
		.fuli-top .middle-col span.active{color:#333;display: inline-block;}
		.fuli-top .middle-col span.active:after{content: " ";width:0.25rem;margin-left:-0.125rem;height:4px;background: #107EFF;bottom:2px;border-radius:3px;position:absolute;left:50%;display: block;}

		.fuli-temai-list{padding:0.15rem 15px 0.2rem 15px;;}
		.fuli-temai-list li{position: relative;height:2.17rem;
			background:rgba(255,255,255,1);
			box-shadow:0px 2px 6px 0px rgba(126,125,125,0.16);
			border-radius:3px;
			margin-bottom:0.14rem;
		}

		.fuli-temai-list li p{font-size:0.14rem;color:#333333;margin:0;padding:0.1rem 0.1rem 0.02rem 0.1rem;}
		.fuli-temai-list li div{color:#FF5269;padding-left:0.1rem;font-size: 0.16rem;}
		.fuli-temai-list li div span{font-size:0.12rem;}
		.fuli-temai-list li button{background: #F39800;color:#fff;border:0;width:0.89rem;line-height:0.36rem;padding:0;position: absolute;right:0.1rem;bottom:0.15rem;}

		.fuli-temai-list li img{display: block;width:100%;}
		.swiper-banner img{display: block;width:100%;}
		.swiper-tab-col{overflow:visible!important;}
		.tab-col{width:100%;overflow: hidden;}


			.modal-mask {
			    width: 100%;
			    height: 100%;
			    position: fixed;
			    top: 0;
			    left: 0;
			    background: rgba(0, 0, 0, 0.4);
			    overflow: hidden;
			    z-index: 10;
			    color: #fff;
			    justify-content: center;
			    align-items: center;
			}
			
			.modal-dialog {
			    width: 80%;
			    height: 2.18rem;
			    overflow: auto;
			    border-radius: 0.18rem;
			    position: relative;
			    border-radius: 0.04rem;
				background-color: #FFFFFF;
			}
			
			.close_style {
			    position: absolute;
			    top: 0.15rem;
			    right: 0.15rem;
			    width: 0.12rem;
			    height: 0.12rem;
			    z-index: 100000;
			}
			
			.modal-content {
			    font-size: 0.12rem;
			    position: relative;
			    z-index: 10000;
			    color: #333333;
			    background: #ffffff;
			    padding: 0px;
			}
			
			.modal-content .title{
				color: #FF5269;
				font-size: 0.18rem;
				text-align: center;
				width: 100%;
				margin-top: 0.4rem;
			}
			
			.modal-content .img{
				text-align: center;
				margin: 0.2rem auto 0.3rem;
				
			}
			
			.modal-content .img img{
				width: 2.4rem;
				height: 0.6rem;
			}
			
			.fuli-list-empty{
				margin-top: 1rem;
			}
	</style>

</head>

<body>


<div class="status-bar" id="statusBar"></div>

<div class="fuli-top">

	<div class="left-col">
		<div  id="louyuText"><span>请选择楼宇</span></div>
		<img src="../images/fuli/fuli_03.jpg"/>
	</div>

	<span class="middle-col">
		<span class="active">会员福利</span>
		<span>线上特卖会</span>
	</span>

	<div class="right-col" id="sosuo">
		<img src="../images/firstPageLive/icon2.png"/>
		<div>搜索</div>
	</div>

</div>

<div style="height:0.6rem;"></div>

<div class="tab-main">

		<div class="tab-col">

			<div class="swiper-container swiper-banner">
				<div class="swiper-wrapper">
					<div class="swiper-slide">
						<img src="../images/fuli/fuli_06.jpg">
					</div>
					<div class="swiper-slide">
						<img src="../images/fuli/fuli_06.jpg">
					</div>
					<div class="swiper-slide">
						<img src="../images/fuli/fuli_06.jpg">
					</div>
				</div>


				<div class="swiper-pagination swiper-banner-pagination"></div>
			</div>


			<div class="swiper-container swiper-tab-col buzhou-list">

				<div class=" swiper-wrapper clearfix time_wrap">

				</div>

		    </div>

			<div class="pd">

				<ul class="fuli-list">
					<li>
						<img class="img" src="../images/fuli/fuli_15.jpg">
						<div>
							<div class="biaoti">GUCCI 八折优惠券</div>
							<p class="weizhi"><img  src="../images/fuli/weizhi.jpg"/>上海歌斐中心</p>
							<div class="riqi">2018-01-01 至 2018-12-31</div>
						</div>

						<div class="lingqu">
							<div>立即</div>
							<div>领取</div>
						</div>

					</li>

					
				</ul>
				
				<div class="row_center fuli-list-empty hideClass">暂无数据</div>

			</div>
		</div>

		<div class="tab-col hide">

			<ul class="fuli-temai-list">
				<li>
					<img src="../images/fuli/temai_08.jpg">
					<p>景德镇优质青花瓷碗</p>
					<div><span>¥</span>928.00</div>
					<button type="button">立即抢购</button>
				</li>
			</ul>
			
			<div class="row_center temai-list-empty hideClass">暂无数据</div>

		</div>

		<div class="modal-mask row hideClass">
		    <div class="modal-dialog">
		        <img src="../images/login/login_close.png" class="close_style" onclick="closeDialg();" />
		        <div class="modal-content">
		            <div class="title">恭喜您获得奖品</div>
					<div class="img">
						<img src="../images/fuli/fuliImg.png" onclick="goToCoupon();">
					</div>
					<div class="btn" onclick="closeDialg();">确认</div>
		        </div>
		    </div>
		</div>

	</div>

<script type="text/html" id="timeList">
	{{each data as item i}}
	{{if item.status==0}}
		<div class="swiper-slide disabled" data-id="{{item.time}}">
	{{else if item.status==1}}
		<div class="swiper-slide active" data-id="{{item.time}}">
	{{else}}
		<div class="swiper-slide" data-id="{{item.time}}">
	{{/if}}
			<span>{{item.label}}</span>
			<div>{{item.text}}</div>
		</div>
	{{/each}}
</script>


<script type="text/html" id="couponList">
	{{each data as item i}}
		<li>
			<img class="img" src="../images/fuli/fuli_15.jpg">
			<div>
				<div class="biaoti">GUCCI 八折优惠券</div>
				<p class="weizhi"><img  src="../images/fuli/weizhi.jpg"/>上海歌斐中心</p>
				<div class="riqi">2018-01-01 至 2018-12-31</div>
			</div>
		
			<div class="lingqu">
				<div>立即</div>
				<div>领取</div>
			</div>
		
		</li>
	{{/each}}
</script>


<script type="text/html" id="promotionsList">
	{{each data as item i}}
		<li>
			<img src="../images/fuli/temai_08.jpg">
			<p>景德镇优质青花瓷碗</p>
			<div><span>¥</span>928.00</div>
			<button type="button">立即抢购</button>
		</li>
	{{/each}}
</script>
	
<script src="../js/mui.min.js"></script>
<script src="../js/jquery-2.1.1.min.js"></script>
<script src="../lib/artTemplate.js"></script>
<script src="../lib/swiper.min.js"></script>
<script src="../js/myStorage.js"></script>
<script src="../js/app.js"></script>
<script>
	
	mui.init();
	mui.plusReady(function() {
			var topHeight=plus.navigator.getStatusbarHeight();
			if(mui.os.android)
			{
				$("#statusBar").height(topHeight);
			}
		   commonEvent();
		   httpRequest();
			
	});
	
	var curTime = 12;
	function httpRequest() {
	    Global.commonAjax({
	        url: "welfare/coupons/today"
	    }, function (data) {
	        if (data) {
				render('.time_wrap', 'timeList', { data: data }, true);
				data.map(function(item){
					if(item.status == 1){
						curTime = item.time;
						// getCoupon();
						return;
					}
				});
	        }
	    }, function (err) {
	        console.log("获取快递公司" + JSON.stringify(err));
	    })
	}
	
	//福利列表
	function getCoupon() {
	    Global.commonAjax({
	        url: "welfare/coupons?time="+curTime
	    }, function (data) {
	        if (data) {
				var list = data.data;
				console.log(list);
				if(list.length > 0){
					$(".fuli-list").removeClass("hideClass");
					$(".fuli-list-empty").addClass("hideClass");
					render('.fuli-list', 'couponList', { data: list }, true);
				}else{
					$(".fuli-list").addClass("hideClass");
					$(".fuli-list-empty").removeClass("hideClass");
					
				}
				
				
	        }
	    }, function (err) {
	        console.log("getCoupon" + JSON.stringify(err));
			mui.toast(err);
	    })
	}
	
	//线上特卖会 列表
	function promotionsList(){
		Global.commonAjax({
		    url: "shop/goods/promotions"
		}, function (data) {
		    if (data) {
				var list = data.data;
				console.log(list);
				if(list.length > 0){
					$(".fuli-temai-list").removeClass("hideClass");
					$(".temai-list-empty").addClass("hideClass");
					render('.fuli-temai-list', 'promotionsList', { data: list }, true);
				}else{
					$(".fuli-temai-list").addClass("hideClass");
					$(".temai-list-empty").removeClass("hideClass");
					
				}
				
				
		    }
		}, function (err) {
		    console.log("promotionsList" + JSON.stringify(err));
			mui.toast(err);
		})
	}
	

	var swiper = new Swiper('.swiper-banner', {
		pagination: {
			el: '.swiper-banner-pagination',
		}
	});

	var swiperDetail = new Swiper('.swiper-tab-col', {
		slidesPerView: 5,
		spaceBetween: 0,
		on:{
			slideChange: function(index){

			},
		},

	});

	$(".buzhou-list .swiper-slide").click(function()
	{
		$(".buzhou-list .swiper-slide").removeClass("active");
		$(this).addClass("active");



	});

	//会员福利 点击事件
	mui(".fuli-list").on('tap','li',function(){

		Global.openWindow({
			url: 'fuliShiyong.html',
			id: 'fuliShiyong.html',
			waiting: {
				autoShow: false
			}
		})

	});
	
	//线上特卖 点击事件
	mui(".fuli-temai-list").on('tap','li',function(){
		mui.alert("点击了")
	
// 		Global.openWindow({
// 			url: 'fuliShiyong.html',
// 			id: 'fuliShiyong.html',
// 			waiting: {
// 				autoShow: false
// 			}
// 		})
	
	});
	
	mui(".time_wrap").on('tap','.swiper-slide',function(){
	
		$(".time_wrap .swiper-slide").removeClass("active");
		$(this).addClass("active");
		curTime = $(this).data("id");
		getCoupon();
	});
	
	//点击右上角 搜索
	mui(".fuli-top").on('tap','#sosuo',function(){
	
		Global.openWindow({
			url: 'mall_order.html',
			id: 'mall_order.html',
			waiting: {
				autoShow: false
			}
		})
	});
	



	$(".middle-col span").click(function()
	{
		$(".middle-col span").removeClass("active");
		$(this).addClass("active");
		$(".tab-main .tab-col").hide();
		$(".tab-main .tab-col").eq($(this).index()).show();

	});

	$(".fuli-temai-list li").click(function()
	{
			//$(".modal-mask").removeClass("hideClass");

	});
		
		function closeDialg(){
			$(".modal-mask").addClass("hideClass");
		}
		


	


</script>
</body>

</html>